# 2026-02-19 随机点名功能增强

## 本日目标
为随机点名工具增加多人抽取和答对加分两项能力。

## 完成内容

### 1. 多人抽取
- 新增抽取人数输入控件（紧凑数字输入框：−/输入框/+），范围 1 ~ 学生总数
- 单人模式保持原有聚光灯动画（逐步收敛到目标）
- 多人模式新增随机闪烁动画：N 个位置同步高亮，~30 步从快到慢，最后定格到目标，停留 600ms 后弹出结果
- `selectedIndex` 改为 `selectedIndices` 数组，`highlightIndex` 改为 `highlightIndices` 数组
- 多人模式下所有被选中学生 ID 均加入 history，剩余不足时自动重置一轮

### 2. 答对加分（与点名结果分离）
- 结果页默认只展示点名结果 + 操作按钮（答对加分 / 再来一次 / 返回列表）
- 点击"答对加分"进入加分模式：
  - 顶部提示"点击头像选择答对的同学"
  - 卡片变为可点击，选中后绿色边框 + ✓ 勾标记
  - 底部展开分值输入（CompactNumberInput，1~99）+ 确认加分按钮
- 可"取消加分"退出加分模式，回到纯结果展示
- 调用 `CloudApi.scoreBatch()`，ruleId: `roll-call-reward`，ruleName: `点名加分`
- 加分完成后按钮变为"已加分"，防止重复加分

### 3. CompactNumberInput 组件
- 提取为 RollCall.tsx 内的局部组件，供抽取人数和加分分值两处复用
- 支持 min/max/suffix/disabled，点击 ±1 或直接键入，超出范围自动 clamp
- 隐藏原生 number input spinner

## 遇到的问题
- 多人模式最初无动画直接出结果，用户体验不佳 → 加上随机闪烁动画
- 加分和点名结果最初强绑定，所有被点名学生都必须走加分流程 → 拆分为独立的加分模式入口
- 预设按钮组（[1][2][3][4][5]）不够灵活 → 改为自由输入的紧凑数字控件

## 解决方案
- 多人动画：每步随机 N 个不重复索引做高亮，步间延迟二次缓出（60ms → 310ms）
- 加分模式：新增 `rewarding` 布尔状态控制，卡片根据该状态决定是否可点击（button vs div）
- 数字输入：CompactNumberInput 组件内部 clamp + onBlur 兜底

## 相关文件
- `app/src/components/tools/RollCall.tsx` — 核心改动
