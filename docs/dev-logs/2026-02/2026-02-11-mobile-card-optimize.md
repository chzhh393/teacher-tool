# 2026-02-11 手机端学生卡片优化

## 本日目标

老师反馈手机端一屏只能看 4-6 个学生（2 列布局），希望支持紧凑视图和排序功能。

## 完成内容

### 1. 紧凑模式（大小图标切换）
- 工具栏新增"紧凑/大图"切换按钮，仅手机端可见（`md:hidden`）
- 紧凑模式变化：
  - 网格列数：2 列 → 3 列
  - 间距：`gap-2` → `gap-1.5`
  - 卡片内边距/圆角缩小
  - 幻兽图片 max-h：112px → 64px
  - 名字行字号缩小，省略幻兽名和形态
  - 进度条高度缩小
  - 手机端领养按钮隐藏
  - 批量 checkbox 缩小
- 预计一屏可看 9-12 个学生

### 2. 排序功能
- 工具栏新增原生 `<select>` 下拉框（手机端弹出系统滚轮选择器）
- 三种排序模式：默认 / 按姓名（拼音） / 按累计积分（降序）
- 排序在 `filteredStudents` useMemo 中执行，先过滤再排序

### 3. 偏好持久化
- 排序模式 → `localStorage` 键 `tt-card-sort`
- 卡片大小 → `localStorage` 键 `tt-card-size`
- 刷新页面后保持用户选择

## 遇到的问题

1. **学号排序无意义**：项目当前没有学号字段，去掉"按学号"选项
2. **按积分 vs 按等级重复**：等级由积分推算，两者排序结果基本相同，合并为"按积分"一项
3. **totalScore vs earnedScore**：`totalScore` 是当前等级成长值（满级重置），排序应使用 `earnedScore`（累计积分）

## 解决方案

- 精简排序选项为 3 个：默认 / 按姓名 / 按积分
- 排序使用 `earnedScore`（累计积分），避免满级重置后排序异常
- 桌面端通过 `md:` 断点覆盖，完全不受紧凑模式影响

## 相关文件

- `app/src/routes/Home.tsx` — 唯一修改的文件
