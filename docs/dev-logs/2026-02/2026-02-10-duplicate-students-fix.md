# 2026-02-10 开发日志

## 本日目标
修复学生添加按钮可重复点击导致大量重复数据的问题，并清理已产生的脏数据。

## 完成内容
1. 排查用户 `xiaoxuetongxue` 的班级 `class-1770688135019` 出现 600 名学生的原因
2. 确认 600 条记录为同一份 50 人名单被重复导入约 12 次
3. 修复前端三个学生添加按钮（添加、批量添加、Excel 导入）缺少 `disabled={loading}` 的问题
4. 清理数据库中的重复班级及关联数据

## 遇到的问题
- 用户 `xiaoxuetongxue` 的班级显示 600 名学生，远超 100 人限制
- 原因：在 v1.4.1 添加 100 人限制之前，前端批量导入按钮没有 `disabled={loading}`，用户连续快速点击导致同一批名单被反复提交

## 解决方案
- **前端防重复**：三个按钮（添加、批量添加、Excel 导入）均添加 `disabled={loading}` + `disabled:opacity-50`，共享同一个 `loading` 状态，任一操作进行中所有按钮都被禁用
- **数据清理**：直接从数据库删除重复班级 `class-1770688135019` 及其关联数据（600 学生 + 63 积分记录 + 1 设置 + 1 班级），保留正常班级 `class-1770688201239`

## 相关文件
- `app/src/routes/Settings.tsx` — 添加按钮 disabled 属性
